<!DOCTYPE html>
<html lang="en">
<head>
<title>Home - Octopus Deploy</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="description" content="Octopus Deploy end user documentation">
<meta name="author" content="Octopus Deploy">
<link href="https://octopus.com/Content/css?v=-4KqQQob8dsL5hdI1n8ITu5WSvQ-X4_-0QjLsU2Qxgo1" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" integrity="sha256-NuCn4IvuZXdBaFKJOAcsU2Q3ZpwbdFisd5dux4jkQ5w=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.0/featherlight.min.css" integrity="sha256-Bl4rr1AwUjcb8VvRrdHXqJvRRCyF7oHsgUl74ELjr7k=" crossorigin="anonymous">
<meta name="viewport" content="width=device-width">
<meta property="og:type" content="website">
<meta property="og:title" content="Home - Octopus Deploy">
<meta property="og:description" content="Octopus Deploy end user documentation">
<meta property="og:site_name" content="Octopus Deploy">
<meta property="twitter:card" content="summary">
<meta property="twitter:site" content="@OctopusDeploy">
<meta name="application-name" content="Octopus Deploy">
<link rel="canonical" href="https://octopus.com/docs">
<link rel="me" type="text/html" href="https://plus.google.com/102650558422902813929?rel=me">
<link rel="me" type="text/html" href="http://feeds.feedburner.com/OctopusDeploy">
<link rel="me" type="text/html" href="https://twitter.com/OctopusDeploy">
<link rel="icon" type="image/png" href="https://octopus.com/content/resources/favicon.png">
<link rel="apple-touch-icon" href="https://octopus.com/content/resources/Octopus-96x96.png">
<link href="http://feeds.feedburner.com/OctopusDeploy" type="application/rss+xml" rel="alternate" title="Octopus Deploy Blog Feed">
<script type="text/javascript">
        !function (a, b, c, d, e, f, g) {
            a.RaygunObject = e, a[e] = a[e] || function () {
                    (a[e].o = a[e].o || []).push(arguments)
                }, f = b.createElement(c), g = b.getElementsByTagName(c)[0],
                f.async = 1, f.src = d, g.parentNode.insertBefore(f, g)
        }(window, document, "script", "//cdn.raygun.io/raygun4js/raygun.min.js", "rg4js");
    </script>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" integrity="sha256-3YM6A3pH4QFCl9WbSU8oXF5N6W/2ylvW0o2g+Z6TmLQ=" crossorigin="anonymous">
<style>
        .btnCopy {
            position: absolute;
            right: 0;
            top: 0;
        }

        .copyToClipboard {
            position: relative;
        }

        @media (min-width: 1200px) {
            .container {
                max-width: 1600px;
                width: 100%;
            }
        }
    </style>
</head>
<body class="">

<script>
        window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) }; ga.l = +new Date;
        ga('create', 'UA-24461753-1', 'auto');
        ga('send', 'pageview');
    </script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>


<script type="text/javascript">
        setTimeout(function () {
            var a = document.createElement("script");
            var b = document.getElementsByTagName("script")[0];
            a.src = document.location.protocol + "//script.crazyegg.com/pages/scripts/0021/2568.js?" + Math.floor(new Date().getTime() / 3600000);
            a.async = true; a.type = "text/javascript"; b.parentNode.insertBefore(a, b)
        }, 1);
    </script>

<div class="top-and-splash">
<div id="top">
<div id="header">
<div class="navbar navbar-fixed-top">
<div class="">
<div class="container">
<div>
<div class="navbar-header">
<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a id="logo" class="navbar-brand" href="/">Octopus Deploy</a>
</div>
<div id="nav-main" class="navbar-collapse collapse">
<div>
<ul class="nav navbar-nav navbar-right">
<li class="">
<a href="/#features">
Features
</a>
</li>
<li class="">
<a href="/downloads">
Downloads
</a>
</li>
<li class="">
<a href="/company/about">
Company
</a>
</li>
<li class="active">
<a href="/docs">
Docs
</a>
</li>
<li class="">
<a href="/support">
Support
</a>
</li>
<li class="">
<a href="/purchase">
Pricing
</a>
</li>
<li class="">
<a href="/blog">Blog</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="middle">
<div id="main">
<div class="stripe stripe-blue">
<div class="container">
<span class="page-title">Octopus Deploy Documentation</span>
</div>
</div>
<div style="padding-left: 16px;" class="stripe stripe-white">
<div class="container">
<div class="row">
<div class="col-md-9">
<div id="doc_content" class="main-content"><h1>GoogleApps authentication</h1><div class="alert alert-info"><p>GoogleApps authentication is available in Octopus Deploy 3.5 and later</p>
</div>
<p>To use GoogleApps authentication with Octopus, GoogleApps must be configured to trust Octopus (by setting it up as an App).  Below are the details for how to configure the App.</p>
<h2 id="GoogleAppsauthentication-ConfiguringGoogleApps">Configuring GoogleApps</h2>
<h3 id="GoogleAppsauthentication-SetupanApp">Set up an App</h3>
<p>To configure an App within GoogleApps, you must have a Developer account at <a href="https://developers.google.com" rel="nofollow">https://developers.google.com</a>.  This account will own the App configuration, so we recommend you create an account for company use, rather than using an individual account.</p>
<p>Once you have an account, log in to <a href="https://console.developers.google.com" rel="nofollow">https://console.developers.google.com</a> and the following actions:</p>
<ol>
<li>Create a project for Octopus (this might take a minute or so) and then within that project</li>
<li>Select <span class="path">API Manager ➜ Credentials Menu</span>.</li>
<li>Set the <strong>OAuth consent screen</strong> information.</li>
<li>Select the Credentials tab and Create a new <strong>OAuth client ID</strong> for a <strong>Web app</strong>.</li>
<li>Enter a <strong>Name</strong> for identification, e.g. Octopus.  This is the name that will appear when the user is asked to allow access to their details.</li>
<li>Add <code>https://octopus.example.com/api/users/authenticatedToken/GoogleApps</code> (replacing <code>https://octopus.example.com</code> with the url of your Octopus server) to the <strong>Authorized Redirect URIs</strong>.</li>
</ol>
<div class="alert alert-info"><p><strong>Reply URLs are case-sensitive</strong><br />
Be aware that the path in this url after the domain name was <strong>case sensitive</strong> during our testing.</p>
</div>
<div class="alert alert-info"><p><strong>Not using SSL?</strong><br />
That's OK, you can use <code>http</code> if you do not have SSL enabled on your Octopus Server. Please beware of the security implications in accepting a security token over an insecure channel.</p>
</div>
<h2 id="GoogleAppsauthentication-ConfiguringOctopusDeployServer">Configuring Octopus Deploy Server</h2>
<p>There is currently no UI for configuring Octopus to use GoogleApps - it must be configured from the command line. You will need the <strong>Client ID</strong> from the Credentials tab and your <strong>hosted domain name</strong>.</p>
<p>Once you have those values, run the following from a command prompt in the folder where you installed Octopus Server:</p>
<pre><code class="language-powershell">Octopus.Server.exe configure --googleAppsIsEnabled=true --googleAppsClientId=ClientID --googleAppsHostedDomain=yourdomain.com
</code></pre>
<h3 id="GoogleAppsauthentication-Octopususeraccountsarestillrequired">Octopus user accounts are still required</h3>
<p>Even if you are using an external identity provider, Octopus still requires a <a href="/docs/v/3.6/administration/managing-users-and-teams">user account</a> so you can assign those people to Octopus teams and subsequently grant permissions to Octopus resources. Octopus will automatically create a <a href="/docs/v/3.6/administration/managing-users-and-teams">user account</a> based on the profile information returned in the security token, which includes an <strong>Identifier</strong>, <strong>Name</strong>, and <strong>Email Address</strong>.</p>
<div class="alert alert-info"><p><strong>How Octopus matches external identities to user accounts</strong><br />
When the security token is returned from the external identity provider, Octopus looks for a user account with a <strong>matching Identifier</strong>. If there is no match, Octopus looks for a user account with a <strong>matching Email Address</strong>. If a user account is found, the External Identifier will be added to the user account for next time. If a user account is not found, Octopus will create one using the profile information in the security token.</p>
</div>
<div class="alert alert-success"><p><strong>Already have Octopus user accounts?</strong><br />
If you already have Octopus user accounts and you want to enable external authentication, simply make sure the Email Address matches in both Octopus and the external identity provider. This means your existing users will be able to sign in using an external identity provider and still belong to the same teams in Octopus.</p>
</div>
<h3 id="getting-permissions">Getting permissions</h3>
<p>If you are installing a clean instance of Octopus Deploy you will need to 'seed' it with at least one admin user. This user then has access to create and configure other users as required. To add a user, execute the following command</p>
<pre><code class="language-powershell">Octopus.Server.exe admin --username USERNAME --email EMAIL
</code></pre>
<p>The most important part in this command is email, as usernames are not necessarily included in the claims from the external providers. When the user logs in the matching logic must be able to align their user record based on the email from the external provider or they will not be granted permissions.</p>
<h2 id="GoogleAppsauthentication-Troubleshooting">Troubleshooting</h2>
<p>We do our best to log warnings to your Octopus Server log whenever possible. If you are having difficulty configuring Octopus to authenticate with GoogleApps, be sure to check your <a href="/docs/v/3.6/reference/log-files">server logs</a> for warnings.</p>
<h3 id="GoogleAppsauthentication-DoubleandTriplecheckyourconfiguration">Double and Triple check your configuration</h3>
<p>Unfortunately security-related configuration is sensitive to everything. Make sure:</p>
<ul>
<li>you don't have any typos or copy-paste errors</li>
<li>remember things are case-sensitive</li>
<li>remember to remove or add slash characters as we've instructed - they matter too!</li>
</ul>
<h3 id="GoogleAppsauthentication-CheckOpenIDConnectmetadataisworking">Check OpenID Connect metadata is working</h3>
<p>You can see the OpenID Connect metadata by going to <a href="https://accounts.google.com/.well-known/openid-configuration" rel="nofollow">https://accounts.google.com/.well-known/openid-configuration</a>.</p>
<h3 id="GoogleAppsauthentication-Inspectthecontentsofthesecuritytoken">Inspect the contents of the security token</h3>
<p>Perhaps the contents of the security token sent back by GoogleApps aren't exactly the way Octopus expected, especially certain claims which may be missing or named differently. This will usually result in the GoogleApps user incorrectly mapping to a different Octopus User than expected. The best way to diagnose this is to inspect the JSON Web Token (JWT) which is sent from GoogleApps to Octopus via your browser. To inspect the contents of your security token:</p>
<ol>
<li><p>Open the Developer Tools of your browser and enable Network logging making sure the network logging is preserved across requests.</p>
</li>
<li><p>In Chrome Dev Tools this is called &quot;Preserve Log&quot;.<br />
<img src='/docs/images/5670656/5866122.png' class="img-fluid center" alt='' /></p>
</li>
<li><p>Attempt to sign into Octopus using GoogleApps and find the HTTP POST coming back to your Octopus instance from GoogleApps on a route like <code>/api/users/authenticatedToken/GoogleApps</code>. You should see an <code>id_token</code> field in the HTTP POST body. 
<a href='#' data-featherlight='/docs/images/5670664/5866125.png' class='zoom' data-title=''><img src='/docs/images/5670664/5866125.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Grab the contents of the <code>id_token</code> field and paste that into <a href="https://jwt.io/" rel="nofollow">https://jwt.io/</a> which will decode the token for you.<br />
<a href='#' data-featherlight='/docs/images/5670656/5866123.png' class='zoom' data-title=''><img src='/docs/images/5670656/5866123.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Don't worry if jwt.io complains about the token signature, it doesn't support RS256 which is used by GoogleApps.</p>
</li>
<li><p>Octopus uses most of the data to validate the token, but primarily uses the <code>sub</code>, <code>email</code> and <code>name</code> claims. If these claims are not present you will likely see unexpected behavior.</p>
</li>
<li><p>If you are not able to figure out what is going wrong, please send a copy of the decoded payload to our <a href="https://octopus.com/support">support team</a> and let them know what behavior you are experiencing.</p>
</li>
</ol>
</div>
</div>
<div class="col-md-3" style="padding-bottom: 100px">
<div class="panel panel-info documentation">
<div class="panel-heading">
<div class="panel-title">
<a href="/docs">Documentation</a>
<div style="margin-top: -3px; margin-bottom: 0" class="dropdown pull-right">
<button class="btn btn-info btn-xs dropdown-toggle" type="button" id="versionSelector" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
Latest
<span class="caret"></span>
</button>
<ul class="dropdown-menu" aria-labelledby="versionSelector"><li class=''><a href='/docs/administration/authentication-providers/googleapps-authentication'>Latest</a></li><li class=''><a href='/docs/v/3.15/administration/authentication-providers/googleapps-authentication'>3.15</a></li><li class=''><a href='/docs/v/3.14/administration/authentication-providers/googleapps-authentication'>3.14</a></li><li class=''><a href='/docs/v/3.13/administration/authentication-providers/googleapps-authentication'>3.13</a></li><li class=''><a href='/docs/v/3.12/administration/authentication-providers/googleapps-authentication'>3.12</a></li><li class=''><a href='/docs/v/3.11/administration/authentication-providers/googleapps-authentication'>3.11</a></li><li class=''><a href='/docs/v/3.10/administration/authentication-providers/googleapps-authentication'>3.10</a></li><li class=''><a href='/docs/v/3.9/administration/authentication-providers/googleapps-authentication'>3.9</a></li><li class=''><a href='/docs/v/3.8/administration/authentication-providers/googleapps-authentication'>3.8</a></li><li class=''><a href='/docs/v/3.7/administration/authentication-providers/googleapps-authentication'>3.7</a></li><li class='disabled'><a href='/docs/v/3.6/administration/authentication-providers/googleapps-authentication'>3.6</a></li></ul>
</div>
</div>
</div>
<div class="panel-body">
<form action="/search" method="get"> <div class="form-search search-only">
<i class="search-icon fa fa-search"></i>
<input id="context" name="context" type="hidden" value="docs">
<input class="form-control search-query" id="q" name="q" placeholder="Search" type="text" value/="">
</div>
</form>
<div class="sidebar">
<ul>
<li>
<a class=" " href="/docs/getting-started">Getting started</a>
</li>
<li>
<a class=" has-children" href="/docs/installation">Installation</a>
</li>
<li>
<a class=" has-children" href="/docs/key-concepts">Key Concepts</a>
</li>
<li>
<a class=" has-children" href="/docs/packaging-applications">Packaging applications</a>
</li>
<li>
<a class=" has-children" href="/docs/deployment-targets">Deployment targets</a>
</li>
<li>
<a class=" has-children" href="/docs/deploying-applications">Deploying applications</a>
</li>
<li>
<a class=" has-children" href="/docs/api-and-integration">API and Integration</a>
</li>
<li>
<a class=" has-children" href="/docs/patterns">Patterns</a>
</li>
<li>
<a class=" has-children" href="/docs/administration">Administration</a>
</li>
<li>
<a class=" has-children" href="/docs/reference">Reference</a>
</li>
<li>
<a class=" has-children" href="/docs/how-to">How to</a>
</li>
<li>
<a class=" has-children" href="/docs/guides">Guides</a>
</li>
</ul>
</div>
</div>
</div>
<div class="text-center">
<a href="https://github.com/OctopusDeploy/docs/blob/master/docs/index.md" class="tutorial" rel="nofollow">Edit this page on GitHub</a>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="bottom">
<div id="footer">
<div class="container">
<div class="row">
<div class="col-md-3">
<strong>Octopus Deploy</strong>
<p>
<a href="/company/about">Company</a>
<br>
<a href="/company/testimonials">Testimonials</a>
<br>
<a href="/company/roadmap">Roadmap</a>
<br>
<a href="/privacy">Privacy policy</a>
<br>
<a href="/company/team">Team</a>
</p>
</div>
<div class="col-md-3">
<strong><a href="/docs" style="color: inherit">Documentation</a></strong>
<p>
<a href="/docs/getting-started">
Getting started
</a>
<br>
<a href="/docs/packaging-applications">
Packaging
</a>
<br>
<a href="/docs/deploying-applications">
Deploying applications
</a>
<br>
<a href="/docs/api-and-integration">
REST API and integration
</a>
<br>
<a href="/docs/how-to">
How to
</a>
</p>
</div>
<div class="col-md-3">
<strong><a href="/support" style="color: inherit">Help &amp; Support</a></strong>
<p>
<a href="http://help.octopusdeploy.com/discussions/problems" class="external">
Problems
</a>
<br>
<a href="http://help.octopusdeploy.com/discussions/questions" class="external">
Questions
</a>
<br>
<a href="https://octopusdeploy.uservoice.com/" class="external">
Suggestions
</a>
<br>
<a href="/videos">
Videos
</a>
<br>
<a href="/company/partners">
Partners
</a>
</p>
</div>
<div class="col-md-3" style="text-align: left">
<strong>Follow us</strong>
<p>
<a href="https://twitter.com/OctopusDeploy"><i class="fa fa-fw fa-twitter" style="color: rgb(85, 172, 238);"></i> @OctopusDeploy</a><br>
<a href="https://github.com/OctopusDeploy"><i class="fa fa-fw fa-github" style="color: white"></i> OctopusDeploy</a><br>
<a href="http://www.youtube.com/c/Octopusdeploy"><i class="fa fa-fw fa-youtube-play" style="color: #D52423"></i> YouTube</a><br>
<a href="http://feeds.feedburner.com/OctopusDeploy"><i class="fa fa-fw fa-rss" style="color: orange"></i> Octopus Deploy Blog</a><br>
<a href="https://confirmsubscription.com/h/d/740FABA4D5BBCE4B"><i class="fa fa-fw fa-envelope" style="color: #7BD678"></i> Newsletter</a><br>
</p>
</div>
</div>
</div>
</div>
</div>
<script src="https://octopus.com/bundles/jquery?v=cnl66tdQfXzonUpL0zSMnDJgJiJJfXbV8tKD-S_8H_Q1"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.0/featherlight.min.js" integrity="sha256-zTDNEf7J+bPdCSndhy8DppFjxfRGG5BFJW5obpl0XQs=" crossorigin="anonymous"></script>
<script type="text/javascript">
        (function ($) {
            var ts;

            $("div.navbar-fixed-top").autoHidingNavbar();

            $.featherlight.defaults.closeOnClick = 'anywhere';
            $.featherlight.defaults.afterOpen = function () {
                ts = + new Date();
                $(window).on('scroll', closeFeatherlightOnScroll);
            };

            function closeFeatherlightOnScroll(event) {
                var nowTs = + new Date();

                if (ts + 500 > nowTs) {
                    return;
                }
                $.featherlight.close(event);
                $(window).off('scroll', closeFeatherlightOnScroll);
            }
        })($);
    </script>
 <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/sql.min.js" integrity="sha256-J7HuqMJTEc5SsyA8nOP0+kVUMGlQq0LrQAvAVgs1k1E=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/powershell.min.js" integrity="sha256-cRUESDACI7Yr/eSmoHs6zDQu6HmpAkCp0s4xrZ9RnE0=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/dockerfile.min.js" integrity="sha256-putofyQv7OB569xAldpyBnHJ0Uc+7VGp5Us05IgDGss=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/fsharp.min.js" integrity="sha256-EwjgDftHUX2pcHkcn19JrQPazoBiHIDivBrellTCYnA=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.2/anchor.min.js" integrity="sha256-WofcoLT8gToeaSmVRe28qpnlFxdBJH1n4K6Bk3YowvU=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twemoji/2.2.3/twemoji.min.js" integrity="sha256-Y3KC8juDUsBOzJ3XtOH/sj+BAlF9AQr6pEey+4ibaJ4=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js" integrity="sha256-Gn7MUQono8LUxTfRA0WZzJgTua52Udm1Ifrk5421zkA=" crossorigin="anonymous"></script>
<script type="text/javascript">
        (function($) {
            $('time').each(function(i, e) {
                var time = moment($(e).attr('datetime')).fromNow();
                $(e).html(time);
            });

            hljs.initHighlightingOnLoad();

            anchors.options.placement = 'left';
            anchors.add('#doc_content > h1, #doc_content > h2, #doc_content > h3, #doc_content > h4');

            twemoji.parse(document.body,
            {
                size: '16x16',
                base: 'https://cdnjs.cloudflare.com/ajax/libs/twemoji/2.2.3/'
            });
            
            function canCopyToClipboard() {
                return window.clipboardData && window.clipboardData.setData ||
                    document.queryCommandSupported && document.queryCommandSupported("copy");
            };

            function copyToClipboard(text) {
                if (window.clipboardData && window.clipboardData.setData) {
                    $(window).trigger("copy", e);
                    return clipboardData.setData("Text", text);

                } else if (document.queryCommandSupported && document.queryCommandSupported("copy")) {
                    var textarea = document.createElement("textarea");
                    textarea.textContent = text;
                    textarea.style.position = "fixed";
                    document.body.appendChild(textarea);
                    textarea.select();
                    try {
                        return document.execCommand("copy");
                    } catch (ex) {
                        console.warn("Copy to clipboard failed.", ex);
                        return false;
                    } finally {
                        document.body.removeChild(textarea);
                    }
                }

                return false;
            };

            if (canCopyToClipboard()) {
                var copyButton =
                    $("<a title=\"Copy to clipboard\" class=\"btnCopy btn btn-default btn-xs\" href=\"#\" role=\"button\">Copy</a>");
                copyButton.click(function (e) {
                    var el = $(this).parent().next().find("code");
                    if (el) {
                        copyToClipboard(el[0].textContent);
                        $(this).attr("title", "Copied!").tooltip("fixTitle").tooltip("show")
                               .attr("title", "Copy to clipboard").tooltip("fixTitle");
                    }
                    e.stopPropagation();
                    return false;
                });

                var wrapperForButton =
                    $("<div class=\"copyToClipboard\"></div>").append(copyButton);

                $("pre").before(wrapperForButton);
                $("a.btnCopy").tooltip();
            }
        })($);
    </script>
<script type="text/javascript">
        rg4js('apiKey', 'x6kh9H0AxbqPLcjQVaOZNQ==');
        rg4js('enablePulse', true);
        rg4js('enableCrashReporting', true);
    </script>


</body>
</html>
