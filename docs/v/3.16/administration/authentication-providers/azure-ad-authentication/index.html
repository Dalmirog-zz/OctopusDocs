<!DOCTYPE html>
<html lang="en">
<head>
<title>Getting started - Octopus Deploy</title>
<meta charset="utf-8">
<meta name="description" content="From download to deployment, this guide walks you through getting started with Octopus.">
<meta name="author" content="Octopus Deploy">
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,700" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" integrity="sha256-NuCn4IvuZXdBaFKJOAcsU2Q3ZpwbdFisd5dux4jkQ5w=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.0/featherlight.min.css" integrity="sha256-Bl4rr1AwUjcb8VvRrdHXqJvRRCyF7oHsgUl74ELjr7k=" crossorigin="anonymous">
<link rel="stylesheet" href="https://octopus.com/css/lib.min.css?v=kEfV6kYMfTqo5GWH8cZiJKRh0-G2z2KKepFAdIve3gc">
<link rel="stylesheet" href="https://octopus.com/css/site.min.css?v=uS8Hy-ONZoqeDUdo2owrhAUj0Zt7jsVBc4uxS3TFuCY">
<script src="https://cdn.optimizely.com/js/590800530.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="website">
<meta property="og:title" content="Getting started - Octopus Deploy">
<meta property="og:description" content="From download to deployment, this guide walks you through getting started with Octopus.">
<meta property="og:site_name" content="Octopus Deploy">
<meta property="twitter:card" content="summary">
<meta property="twitter:site" content="@OctopusDeploy">
<meta name="application-name" content="Octopus Deploy">
<link rel="canonical" href="https://octopus.com/docs/getting-started">
<link rel="me" type="text/html" href="https://plus.google.com/102650558422902813929?rel=me">
<link rel="me" type="text/html" href="http://feeds.feedburner.com/OctopusDeploy">
<link rel="me" type="text/html" href="https://twitter.com/OctopusDeploy">
<link rel="icon" type="image/png" href="https://octopus.com/images/(global)/favicon.png">
<link rel="apple-touch-icon" href="https://octopus.com/images/(global)/apple-touch-icon.png">
<link href="http://feeds.feedburner.com/OctopusDeploy" type="application/rss+xml" rel="alternate" title="Octopus Deploy Blog Feed">
<link rel="search" type="application/opensearchdescription+xml" href="https://octopus.com/search/opensearchdescription" title="Octopus Deploy">
<script type="text/javascript">
        !function(a,b,c,d,e,f,g,h){a.RaygunObject=e,a[e]=a[e]||function(){
                (a[e].o=a[e].o||[]).push(arguments)},f=b.createElement(c),g=b.getElementsByTagName(c)[0],
            f.async=1,f.src=d,g.parentNode.insertBefore(f,g),h=a.onerror,a.onerror=function(b,c,d,f,g){
                h&&h(b,c,d,f,g),g||(g=new Error(b)),a[e].q=a[e].q||[],a[e].q.push({
                    e:g})}}(window,document,"script","//cdn.raygun.io/raygun4js/raygun.min.js","rg4js");
    </script>
<link rel="stylesheet" href="https://octopus.com//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" integrity="sha256-3YM6A3pH4QFCl9WbSU8oXF5N6W/2ylvW0o2g+Z6TmLQ=" crossorigin="anonymous">
<style>
        .btnCopy {
            position: absolute;
            right: 0;
            top: 0;
        }

        .copyToClipboard {
            position: relative;
        }

        @media (min-width: 1200px) {
            .container {
                max-width: 1600px;
                width: 100%;
            }
        }
    </style>
</head>
<body class="">

<script>
        window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) }; ga.l = +new Date;
        ga('create', 'UA-24461753-1', 'auto');
        ga('send', 'pageview');
    </script>
 <script async="" src="https://www.google-analytics.com/analytics.js"></script>


<script type="text/javascript">
        setTimeout(function () {
            var a = document.createElement("script");
            var b = document.getElementsByTagName("script")[0];
            a.src = document.location.protocol + "//script.crazyegg.com/pages/scripts/0021/2568.js?" + Math.floor(new Date().getTime() / 3600000);
            a.async = true; a.type = "text/javascript"; b.parentNode.insertBefore(a, b)
        }, 1);
    </script>



<script type='text/javascript'>
        (function() {
            var w = window, d = document;
            var s = d.createElement('script');
            s.setAttribute('async', 'true');
            s.setAttribute('type', 'text/javascript');
            s.setAttribute('src', '//c1.rfihub.net/js/tc.min.js');
            var f = d.getElementsByTagName('script')[0];
            f.parentNode.insertBefore(s, f);
            if (typeof w['_rfi'] !== 'function') {
                w['_rfi']=function() {
                    w['_rfi'].commands = w['_rfi'].commands || [];
                    w['_rfi'].commands.push(arguments);
                };
            }
            _rfi('setArgs', 'ver', '9');
            _rfi('setArgs', 'rb', '32733');
            _rfi('setArgs', 'ca', '20781763');
            _rfi('setArgs', '_o', '32733');
            _rfi('setArgs', '_t', '20781763');
            _rfi('track');
        })();
    </script>
<noscript>
        <iframe src='//20781763p.rfihub.com/ca.html?rb=32733&ca=20781763&_o=32733&_t=20781763&ra=YOUR_CUSTOM_CACHE_BUSTER' style='display:none;padding:0;margin:0' width='0' height='0'>
        </iframe>
    </noscript>

<nav class="navbar navbar-inverse navbar-fixed-top">
<div>
<div class="container">
<div>
<div class="navbar-header">
<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a id="logo" class="navbar-brand" href="/"><img src="/images/(global)/octopus-logo.svg" alt="Octopus Deploy" style="width: 30px; height: 32px;">&nbsp;<span class="hidden-sm">Octopus Deploy</span></a>
</div>
<div id="navbar" class="navbar-collapse collapse">
<div>
<ul class="nav navbar-nav navbar-right">
<li class="">
<a href="/#features">
Features
</a>
</li>
<li class="">
<a href="/downloads">
Downloads
</a>
</li>
<li class="">
<a href="/company">
Company
</a>
</li>
<li class="active">
<a href="/docs">
Docs
</a>
</li>
<li class="">
<a href="/support">
 Support
</a>
</li>
<li class="">
<a href="/purchase">
Pricing
</a>
</li>
<li class="">
<a href="/blog">Blog</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</nav>
<main>
<header class="stripe stripe-blue stripe-narrow">
<div class="container">
<div class="row">
<div class="col-sm-9">
<div class="like-h2">Octopus Deploy Documentation</div>
</div>
<div class="col-sm-3">
<div class="text-right">
<form method="get" action="/docs/search">
<div class="visible-xs">&nbsp;</div>
<div class="form-search search-only">
<i class="search-icon fa fa-search"></i>
<input class="form-control search-query" id="q" name="q" placeholder="Search" style="width: 100%; text-overflow: ellipsis;" type="text" value="">
</div>
</form>
</div>
</div>
</div>
</div>
</header>
<section class="stripe stripe-gray docs">
<div class="container">
<div class="row">
<div class="col-sm-9 col-sm-push-3">
<article id="doc-content" class="paper" style="padding-bottom: 100px; min-height: 1000px;"><header>
<div class="dropdown pull-right">
<button class="btn btn-success dropdown-toggle" type="button" id="versionSelector" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
Version: Latest
<span class="caret"></span>
</button>
<ul class="dropdown-menu" aria-labelledby="versionSelector"><li class=''><a href='/docs/v/4.0/administration/authentication-providers/azure-ad-authentication'>4.0</a></li><li class=''><a href='/docs/administration/authentication-providers/azure-ad-authentication'>Latest</a></li><li class='disabled'><a href='/docs/v/3.16/administration/authentication-providers/azure-ad-authentication'>3.16</a></li><li class=''><a href='/docs/v/3.15/administration/authentication-providers/azure-ad-authentication'>3.15</a></li><li class=''><a href='/docs/v/3.14/administration/authentication-providers/azure-ad-authentication'>3.14</a></li><li class=''><a href='/docs/v/3.13/administration/authentication-providers/azure-ad-authentication'>3.13</a></li><li class=''><a href='/docs/v/3.12/administration/authentication-providers/azure-ad-authentication'>3.12</a></li><li class=''><a href='/docs/v/3.11/administration/authentication-providers/azure-ad-authentication'>3.11</a></li><li class=''><a href='/docs/v/3.10/administration/authentication-providers/azure-ad-authentication'>3.10</a></li><li class=''><a href='/docs/v/3.9/administration/authentication-providers/azure-ad-authentication'>3.9</a></li><li class=''><a href='/docs/v/3.8/administration/authentication-providers/azure-ad-authentication'>3.8</a></li><li class=''><a href='/docs/v/3.7/administration/authentication-providers/azure-ad-authentication'>3.7</a></li><li class=''><a href='/docs/v/3.6/administration/authentication-providers/azure-ad-authentication'>3.6</a></li></ul>
</div>
<h1>Azure AD authentication</h1>
<div style="margin: 10px 0; color: #aaa" class="small">Last updated <time datetime="2017-10-24T06:45:02.7253904&#x2B;00:00">2017-10-24T06:45:02.7253904&#x2B;00:00</time></div>
</header><div class="alert alert-info"><p>Azure Active Directory (AAD) authentication is available in Octopus Deploy 3.5 and later</p>
</div>
<p>To use Azure Active Directory (AAD) authentication with Octopus you will need to get a few pieces lined up just right:</p>
<ol>
<li>Configure AAD to trust your Octopus Deploy instance (by setting it up as an App in AAD)</li>
<li>Optionally map AAD Users into Roles so you the users can be automatically connected to Octopus Teams.</li>
<li>Configure your Octopus Deploy instance to trust and use AAD as an Identity Provider.</li>
</ol>
<h2 id="AzureADauthentication-ConfiguringAzureActiveDirectory(AAD)">Configuring Azure Active Directory (AAD)</h2>
<p>The first steps are to configure your Azure Active Directory to trust your instance of Octopus Deploy by configuring an App in your AAD.</p>
<h3 id="AzureADauthentication-ConfigureOctopusDeployasanAppinyourAAD">Configure Octopus Deploy as an App in your AAD</h3>
<div class="alert alert-info"><p>At the time of writing this documentation, the &quot;new&quot; Azure Portal's <strong>Azure Active Directory</strong> feature was in preview.  The following instructions are based on the &quot;old&quot; portal at <a href="https://manage.windowsazure.com" class="alert-link" rel="nofollow">https://manage.windowsazure.com</a>.</p>
</div>
<div class="alert alert-success"><p><strong>Get the right permissions for your Azure Active Directory tenant before starting</strong><br />
In order to configure the your instance of Octopus Deploy as an App, you will need administrator permissions to the desired Azure Active Directory tenant in your subscription.</p>
</div>
<ol>
<li><p>Navigate to Azure Active Directory, select the directory you want to use, and select the Applications tab.</p>
<p><a href='#' data-featherlight='/docs/images/5670656/5865860.png' class='zoom' data-title=''><img src='/docs/images/5670656/5865860.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Click the <strong>ADD</strong> button and select <strong>Add an application my organization is developing</strong>.</p>
<p><a href='#' data-featherlight='/docs/images/5670656/5865861.png' class='zoom' data-title=''><img src='/docs/images/5670656/5865861.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Choose <strong>Web Application and/or Web API</strong> for the <strong>Type</strong>, and enter a <strong>Name</strong> like Octopus Deploy. <em>This is the name that will appear at the top of the Azure authentication page when the users are entering their credentials.</em></p>
<p><a href='#' data-featherlight='/docs/images/5670656/5865862.png' class='zoom' data-title=''><img src='/docs/images/5670656/5865862.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Enter the public URL to your Octopus Server as both the Sign-On URL and AppId URL. <em>In this example we are configuring our own demo server, but you should use the public URL to your own Octopus Server.</em></p>
<p><a href='#' data-featherlight='/docs/images/5670656/5865863.png' class='zoom' data-title=''><img src='/docs/images/5670656/5865863.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
</ol>
<h4 id="AzureADauthentication-ConfiguringtrustedReplyURLs">Configuring trusted Reply URLs</h4>
<p>During the authentication with Azure AD, the user will be directed to an Azure page to enter their credentials. As part of the authentication flow, Octopus passes a Reply URL to tell Azure where to POST the user's security token. This URL must be added to a trusted whitelist in the App configuration or the authentication flow will be terminated by Azure.</p>
<ol>
<li><p>Find your App in AAD and go to the Configure tab.</p>
<p><a href='#' data-featherlight='/docs/images/5670656/5865865.png' class='zoom' data-title=''><img src='/docs/images/5670656/5865865.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Scroll down to find the Reply URL section. Enter the public URL to your Octopus Server with <code>/api/users/authenticatedToken/AzureAD</code>.
In our example this would be <code>https://demo.octopus.com/api/users/authenticatedToken/AzureAD</code></p>
</li>
</ol>
<div class="alert alert-info"><p><strong>Reply URLs are sensitive</strong><br />
Please take care when adding this URL! They are <strong>case-sensitive</strong> and can be sensitive to trailing <strong>slash</strong> characters</p>
</div>
<div class="alert alert-info"><p><strong>Not using SSL?</strong><br />
The specification highly recommends using SSL to ensure the security and integrity of your tokens. You can use <code>http</code> if you do not have SSL enabled on the public interface of your Octopus Server. Please beware of the security implications in accepting a security token over an insecure channel.</p>
</div>
<h4 id="AzureADauthentication-MappingRolesMappingAADUsersintoOctopusTeams(optional)">Mapping AAD Users into Octopus Teams (optional)</h4>
<p>If you want to manage user/team membership via AAD, you will need to configure Roles for your App.  To add a Role(s) you will need to edit the App's manifest.</p>
<ul>
<li><p>In the <a href="https://portal.azure.com" rel="nofollow">modern portal</a> you can edit the manifest directly in the browser</p>
</li>
<li><p>In the <a href="https://manage.windowsazure.com" rel="nofollow">old portal</a> you will need to download and hand-edit the file:</p>
<p><a href='#' data-featherlight='/docs/images/5670656/5865864.png' class='zoom' data-title=''><img src='/docs/images/5670656/5865864.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Select <strong>Manage Manifest</strong> and download your App's manifest JSON file.</p>
</li>
<li><p>Edit the downloaded file to add the required Role(s), see below for further details.</p>
</li>
<li><p>Select <strong>Manage Manifest</strong> and upload the modified manifest.</p>
</li>
</ul>
<p>The example below illustrates two roles, one for administrators and one for application testers.</p>
<div class="alert alert-success"><p>Make sure you replace <code>NEWGUID</code> with a generated guid.</p>
</div>
<pre><code class="language-json">{
  &quot;appId&quot;: &quot;myAppGuid&quot;,
  &quot;appRoles&quot;: [
	{
		&quot;id&quot;: &quot;NEWGUID&quot;,
		&quot;allowedMemberTypes&quot;: [&quot;User&quot;],
		&quot;description&quot;: &quot;Octopus Administrators&quot;,
		&quot;displayName&quot;: &quot;Octopus Admins&quot;,
		&quot;isEnabled&quot;: true,
		&quot;value&quot;: &quot;octopusAdmins&quot;
	},
	{
		&quot;id&quot;: &quot;NEWGUID&quot;,
		&quot;allowedMemberTypes&quot;: [&quot;User&quot;],
		&quot;description&quot;: &quot;Octopus Testers&quot;,
		&quot;displayName&quot;: &quot;Octopus Testers&quot;,
		&quot;isEnabled&quot;: true,
		&quot;value&quot;: &quot;octopusTesters&quot;
	}
  ]
}
</code></pre>
<div class="alert alert-info"><p>The <strong>value</strong> property is the most important one. This value becomes the external Role ID you will use later on when <a href="/docs/v/3.16/administration/managing-users-and-teams" class="alert-link">adding this role to a Team</a> in Octopus Deploy.</p>
</div>
<div class="alert alert-success"><p><strong>Want a more advanced manifest?</strong><br />
For more advanced scenarios, please see the <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-application-manifest/" class="alert-link" rel="nofollow">Azure manifest file documentation</a>.</p>
</div>
<h4 id="AzureADauthentication-SettingupusersandgroupsinAzureAD">Setting up users and groups in Azure AD</h4>
<p>Once the App Role(s) have been defined, users/groups from Azure AD may be mapped into these Roles.</p>
<div class="alert alert-info"><p>At the time of writing, the Azure Active Directory is in preview in the modern portal<a href="https://portal.azure.com" class="alert-link" rel="nofollow"> and mapping users has been problematic.</a> We currently recommend doing this in the old portal.</p>
</div>
<ol>
<li><p>In the old portal, go to the <strong>Applications</strong> tab, select the App and then select the <strong>Users</strong> tab.</p>
<p><a href='#' data-featherlight='/docs/images/5670656/5865867.png' class='zoom' data-title=''><img src='/docs/images/5670656/5865867.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>The users/groups from your Azure AD should be displayed, with the Assigned column indicating whether they are already mapped.</p>
</li>
<li><p>You can click the <strong>Assign</strong> or <strong>Remove</strong> buttons to manage which Users and Groups can access your instance of Octopus Deploy. You can also manage which Roles are assigned to each User and Group.</p>
</li>
</ol>
<div class="alert alert-info"><p>If you only have one Role it will be automatically assigned. If you have <strong>multiple</strong> Roles a popup will appear when you click the <strong>Assign</strong> button so you can select the Role to assign.</p>
</div>
<h2 id="AzureADauthentication-ConfiguringOctopusDeployServer">Configuring Octopus Deploy Server</h2>
<div class="alert alert-info"><p>There is currently no UI for configuring Octopus to use Azure AD - it must be configured from the command line.</p>
</div>
<h3 id="AzureADauthentication-GettheClientIDandIssuer">Get the Client ID and Issuer</h3>
<p>There are two values you will need from the Azure AD configuration to complete the Octopus configuration: the <strong>Client ID</strong> and <strong>Issuer</strong>.</p>
<h4 id="AzureADauthentication-UsingtheoldAzureportal">Using the old Azure portal</h4>
<ol>
<li><p>Find the <strong>Client ID</strong> in your App's <strong>Configure</strong> tab and copy it as-is</p>
<p><a href='#' data-featherlight='/docs/images/5670656/5865868.png' class='zoom' data-title=''><img src='/docs/images/5670656/5865868.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Locate the  GUID for the <strong>Issuer</strong> in the address for the above page</p>
<p><a href='#' data-featherlight='/docs/administration/authentication-providers/issuer.png' class='zoom' data-title=''><img src='/docs/administration/authentication-providers/issuer.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
</ol>
<h4 id="AzureADauthentication-UsingthemodernAzureportal">Using the modern Azure portal</h4>
<ol>
<li><p>In the modern portal, the <strong>Application ID</strong> in your App's <strong>Settings/Properties</strong> is your <strong>Client ID</strong></p>
<p><a href='#' data-featherlight='/docs/images/5670656/5865869.png' class='zoom' data-title=''><img src='/docs/images/5670656/5865869.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>The GUID for the <strong>Issuer</strong> can be found in the Properties of your Actice Directory tenant</p>
<p><a href='#' data-featherlight='/docs/administration/authentication-providers/issuer-n.png' class='zoom' data-title=''><img src='/docs/administration/authentication-providers/issuer-n.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
</ol>
<h3 id="AzureADauthentication-SettingtheClientIDandIssuerintoOctopusDeploy">Setting the Client ID and Issuer into Octopus Deploy</h3>
<div class="alert alert-success"><p>Your <strong>Client ID</strong> should be a GUID.</p>
<p>Your <strong>Issuer</strong> should be a URL like <code>https://login.microsoftonline.com/GUID</code> where the GUID is a special GUID identifying your Azure Active Directory tenant.</p>
</div>
<p>Once you have those values, run the following from a command prompt in the folder where you installed Octopus Server:</p>
<pre><code class="language-powershell">Octopus.Server.exe configure --azureADIsEnabled=true --azureADIssuer=Issuer --azureADClientId=ClientID

#Eg:
# Octopus.Server.exe configure --azureADIsEnabled=true --azureADIssuer=https://login.microsoftonline.com/12341234-xxxx-xxxx-xxxx-xxxxxxxxxxxx --azureADClientId=43214321-xxxx-xxxx-xxxx-xxxxxxxxxxxx
</code></pre>
<h3 id="AzureADauthentication-Octopususeraccountsarestillrequired">Octopus user accounts are still required</h3>
<p>Even if you are using an external identity provider, Octopus still requires a <a href="/docs/v/3.16/administration/managing-users-and-teams">user account</a> so you can assign those people to Octopus teams and subsequently grant permissions to Octopus resources. Octopus will automatically create a <a href="/docs/v/3.16/administration/managing-users-and-teams">user account</a> based on the profile information returned in the security token, which includes an <strong>Identifier</strong>, <strong>Name</strong>, and <strong>Email Address</strong>.</p>
<div class="alert alert-info"><p><strong>How Octopus matches external identities to user accounts</strong><br />
When the security token is returned from the external identity provider, Octopus looks for a user account with a <strong>matching Identifier</strong>. If there is no match, Octopus looks for a user account with a <strong>matching Email Address</strong>. If a user account is found, the External Identifier will be added to the user account for next time. If a user account is not found, Octopus will create one using the profile information in the security token.</p>
</div>
<div class="alert alert-success"><p><strong>Already have Octopus user accounts?</strong><br />
If you already have Octopus user accounts and you want to enable external authentication, simply make sure the Email Address matches in both Octopus and the external identity provider. This means your existing users will be able to sign in using an external identity provider and still belong to the same teams in Octopus.</p>
</div>
<h3 id="getting-permissions">Getting permissions</h3>
<p>If you are installing a clean instance of Octopus Deploy you will need to 'seed' it with at least one admin user. This user then has access to create and configure other users as required. To add a user, execute the following command</p>
<pre><code class="language-powershell">Octopus.Server.exe admin --username USERNAME --email EMAIL
</code></pre>
<p>The most important part in this command is email, as usernames are not necessarily included in the claims from the external providers. When the user logs in the matching logic must be able to align their user record based on the email from the external provider or they will not be granted permissions.</p>
<h2 id="AzureADauthentication-Whatnext?">What next?</h2>
<p>Now you're using an external identity provider it is easy to increase your security. You could consider configuring <a href="https://docs.microsoft.com/en-us/azure/multi-factor-authentication/multi-factor-authentication" rel="nofollow">Multi-Factor Authentication</a> - after all Octopus Deploy has access to your production environments!</p>
<p>You should also consider disabling any authentication providers you aren't using, like Username and Password authentication which can now be disabled since Octopus Deploy 3.5.</p>
<h2 id="AzureADauthentication-Troubleshooting">Troubleshooting</h2>
<p>We do our best to log warnings to your Octopus Server log whenever possible. If you are having difficulty configuring Octopus to authenticate with Azure Active Directory, be sure to check your <a href="/docs/v/3.16/reference/log-files">server logs</a> for warnings.</p>
<h3 id="AzureADauthentication-DoubleandTriplecheckyourconfiguration">Double and Triple check your configuration</h3>
<p>Unfortunately security-related configuration is sensitive to everything. Make sure:</p>
<ul>
<li>you don't have any typos or copy-paste errors</li>
<li>remember things are case-sensitive</li>
<li>remember to remove or add slash characters as we've instructed - they matter too!</li>
</ul>
<h3 id="AzureADauthentication-CheckOpenIDConnectmetadataisworking">Check OpenID Connect metadata is working</h3>
<p>You can see the OpenID Connect metadata by going to the Issuer address in your browser adding<code>/.well-known/openid-configuration</code> to the end. In our example this would have been something like <code>https://login.microsoftonline.com/b91ebf6a-84be-4c6f-97f3-32a1d0a11c8a/.well-known/openid-configuration</code></p>
<h3 id="AzureADauthentication-Inspectthecontentsofthesecuritytoken">Inspect the contents of the security token</h3>
<p>Sometimes the contents of the security token sent back by Azure AD aren't exactly the way Octopus expected, especially certain claims which may be missing or named differently. This will usually result in the Azure AD user incorrectly mapping to a different Octopus User than expected. The best way to diagnose this is to inspect the JSON Web Token (JWT) which is sent from Azure AD to Octopus via your browser. To inspect the contents of your security token:</p>
<ol>
<li><p>Open the Developer Tools of your browser and enable Network logging making sure the network logging is preserved across requests.</p>
</li>
<li><p>In Chrome Dev Tools this is called &quot;Preserve Log&quot;.</p>
<p><a href='#' data-featherlight='/docs/images/5670656/5866122.png' class='zoom' data-title=''><img src='/docs/images/5670656/5866122.png' class="img-fluid center" alt='' /></a></p>
</li>
<li><p>Attempt to sign into Octopus using Azure AD and find the HTTP POST coming back to your Octopus instance from Azure AD on a route like <code>/api/users/authenticatedToken/azureAD</code>. You should see an <code>id_token</code> field in the HTTP POST body.</p>
</li>
<li><p>Grab the contents of the <code>id_token</code> field and paste that into <a href="https://jwt.io/" rel="nofollow">https://jwt.io/</a> which will decode the token for you.</p>
<p><a href='#' data-featherlight='/docs/images/5670656/5866123.png' class='zoom' data-title=''><img src='/docs/images/5670656/5866123.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Don't worry if jwt.io complains about the token signature, it doesn't support RS256 which is used by Azure AD.</p>
</li>
<li><p>Octopus uses most of the data to validate the token, but primarily uses the <code>sub</code>, <code>email</code> and <code>name</code> claims. If these claims are not present you will likely see unexpected behavior.</p>
</li>
</ol>
<h3 id="AzureADauthentication-Getintouchwithoursupportteam">Get in touch with our support team</h3>
<p>If you aren't able to resolve the authentication problems yourself using these troubleshooting tips, please reach out to our <a href="https://octopus.com/support">support team</a> with:</p>
<ol>
<li>The contents of your OpenID Connect Metadata or the link to download it (see above) - this can be different for each Azure AD App.</li>
<li>A copy of the decoded payload for some security tokens (see above) - perhaps some are working as expected and others are not.</li>
<li>A screenshot of the Octopus User Accounts including their username, email address and name.</li>
</ol>
</article>
</div>
<div class="col-sm-3 col-sm-pull-9" style="padding-bottom: 100px;">
<aside class="documentation">
<div class="sidebar">
<ul>
<li class="active expanded ">
<a href="/docs/getting-started">
Getting started
</a>
</li>
<li class="  has-children">
<a href="/docs/installation">
Installation
</a>
</li>
<li class="  has-children">
<a href="/docs/key-concepts">
Key Concepts
</a>
</li>
<li class="  has-children">
<a href="/docs/packaging-applications">
Packaging applications
</a>
</li>
<li class="  has-children">
<a href="/docs/deployment-targets">
Deployment targets
</a>
</li>
<li class="  has-children">
<a href="/docs/deploying-applications">
Deploying applications
</a>
</li>
<li class="  has-children">
<a href="/docs/api-and-integration">
API and Integration
</a>
</li>
<li class="  has-children">
<a href="/docs/patterns">
Patterns
</a>
</li>
<li class="  has-children">
<a href="/docs/administration">
Administration
</a>
</li>
<li class="  has-children">
<a href="/docs/reference">
Reference
</a>
</li>
<li class="  has-children">
<a href="/docs/how-to">
How to
</a>
</li>
<li class="  has-children">
<a href="/docs/guides">
Guides
</a>
</li>
</ul>
</div>
</aside>
<div>
<a href="https://github.com/OctopusDeploy/docs/blob/master/docs/getting-started.md" class="small" style="color: #888; margin-left: 30px;" rel="nofollow">Edit this page on GitHub</a>
</div>
</div>
</div>
</div>
</section>
</main>
<footer class="stripe stripe-dark" id="footer">
<div class="container">
<div class="row">
<div class="col-md-3">
<strong>Octopus Deploy</strong>
<p>
<a href="/company/about">Company</a>
<br>
<a href="/company/roadmap">Roadmap</a>
<br>
<a href="/blog">Blog</a>
<br>
<a href="/privacy">Privacy policy</a>
</p>
</div>
<div class="col-md-3">
<strong><a href="/docs" style="color: inherit">Documentation</a></strong>
<p>
<a href="/docs/getting-started">
Getting started
</a>
<br>
<a href="/docs/packaging-applications">
Packaging
</a>
<br>
<a href="/docs/deploying-applications">
Deploying applications
</a>
<br>
<a href="/docs/api-and-integration">
REST API and integration
</a>
</p>
</div>
<div class="col-md-3">
<strong><a href="/support" style="color: inherit">Help &amp; Support</a></strong>
<p>
<a href="http://help.octopusdeploy.com/discussions/problems" class="external">
Problems
</a>
<br>
<a href="https://octopusdeploy.uservoice.com/" class="external">
Suggestions
</a>
<br>
<a href="/videos">
Videos
</a>
<br>
<a href="/company/partners">
Partners
</a>
</p>
</div>
<div class="col-md-3" style="text-align: left">
<strong>Follow us</strong>
<p>
<a href="https://twitter.com/OctopusDeploy"><i class="fa fa-fw fa-twitter" style='color: rgb(85, 172, 238);'></i> @OctopusDeploy</a><br>
<a href="https://github.com/OctopusDeploy"><i class="fa fa-fw fa-github" style='color: white'></i> OctopusDeploy</a><br>
<a href="http://www.youtube.com/c/Octopusdeploy"><i class="fa fa-fw fa-youtube-play" style='color: #D52423'></i> YouTube</a><br>
<a href="https://confirmsubscription.com/h/d/740FABA4D5BBCE4B"><i class="fa fa-fw fa-envelope" style='color: #7BD678'></i> Newsletter</a><br>
</p>
</div>
</div>
</div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>
<script src="/js/lib.min.js?v=H7vT1bydGbJ--2dVXM72f6mvrmccXO1_ZngVo1ljMow"></script>
<script src="/js/site.min.js?v=BbAxgvM4cAEWAnX6fUFBDmgll4Ezt--tMgEDROsJQzU"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/sql.min.js" integrity="sha256-J7HuqMJTEc5SsyA8nOP0+kVUMGlQq0LrQAvAVgs1k1E=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/powershell.min.js" integrity="sha256-cRUESDACI7Yr/eSmoHs6zDQu6HmpAkCp0s4xrZ9RnE0=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/dockerfile.min.js" integrity="sha256-putofyQv7OB569xAldpyBnHJ0Uc+7VGp5Us05IgDGss=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/fsharp.min.js" integrity="sha256-EwjgDftHUX2pcHkcn19JrQPazoBiHIDivBrellTCYnA=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.2/anchor.min.js" integrity="sha256-WofcoLT8gToeaSmVRe28qpnlFxdBJH1n4K6Bk3YowvU=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twemoji/2.2.3/twemoji.min.js" integrity="sha256-Y3KC8juDUsBOzJ3XtOH/sj+BAlF9AQr6pEey+4ibaJ4=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js" integrity="sha256-Gn7MUQono8LUxTfRA0WZzJgTua52Udm1Ifrk5421zkA=" crossorigin="anonymous"></script>
<script type="text/javascript">
        (function($) {
            $('time').each(function(i, e) {
                var time = moment($(e).attr('datetime')).fromNow();
                $(e).html(time);
            });

            hljs.initHighlightingOnLoad();

            anchors.options.placement = 'left';
            anchors.add('#doc-content > h1, #doc-content > h2, #doc-content > h3, #doc-content > h4');

            twemoji.parse(document.body,
            {
                size: '16x16',
                base: 'https://cdnjs.cloudflare.com/ajax/libs/twemoji/2.2.3/'
            });
            
            function canCopyToClipboard() {
                return window.clipboardData && window.clipboardData.setData ||
                    document.queryCommandSupported && document.queryCommandSupported("copy");
            };

            function copyToClipboard(text) {
                if (window.clipboardData && window.clipboardData.setData) {
                    $(window).trigger("copy", e);
                    return clipboardData.setData("Text", text);

                } else if (document.queryCommandSupported && document.queryCommandSupported("copy")) {
                    var textarea = document.createElement("textarea");
                    textarea.textContent = text;
                    textarea.style.position = "fixed";
                    document.body.appendChild(textarea);
                    textarea.select();
                    try {
                        return document.execCommand("copy");
                    } catch (ex) {
                        console.warn("Copy to clipboard failed.", ex);
                        return false;
                    } finally {
                        document.body.removeChild(textarea);
                    }
                }

                return false;
            };

            if (canCopyToClipboard()) {
                var copyButton =
                    $("<a title=\"Copy to clipboard\" class=\"btnCopy btn btn-default btn-xs\" href=\"#\" role=\"button\">Copy</a>");
                copyButton.click(function (e) {
                    var el = $(this).parent().next().find("code");
                    if (el) {
                        copyToClipboard(el[0].textContent);
                        $(this).attr("title", "Copied!").tooltip("fixTitle").tooltip("show")
                               .attr("title", "Copy to clipboard").tooltip("fixTitle");
                    }
                    e.stopPropagation();
                    return false;
                });

                var wrapperForButton =
                    $("<div class=\"copyToClipboard\"></div>").append(copyButton);

                $("pre").before(wrapperForButton);
                $("a.btnCopy").tooltip();
            }
        })($);
    </script>
<script type="text/javascript">
        $(function () { 
            var $feedback = $("#docs-feedback");
            var $initialView = $(".initial-view", $feedback);
            var $yesView = $(".yes-view", $feedback);
            var $feedbackView = $(".feedback-view", $feedback);
            var $confirmationView = $(".confirmation-view", $feedback);

            $yesView.hide();
            $feedbackView.hide();
            $confirmationView.hide();

            var yesOrNo = "";
            var message = "";

            function sendFeedback(message) {
                $.post("/docs/feedback", { slug : "docs/getting-started", helped : yesOrNo, message : message });
            };

            $(".close", $feedback).click(function () {
                $feedback.fadeOut(300);
            });

            var yesTimer = null;

            $(".no", $feedback).click(function () {
                yesOrNo = "no";
                sendFeedback();
                $initialView.fadeOut(function () {
                    $feedbackView.show();
                });
            });

            $(".yes", $feedback).click(function () {
                yesOrNo = "yes";
                sendFeedback();

                $initialView.fadeOut(function () {
                    $yesView.show();
                });

                yesTimer = setTimeout(function () {
                    $feedback.fadeOut();
                }, 10000);
            });
            $(".suggestion", $feedback).click(function (e) {
                if (yesTimer) {
                    clearTimeout(yesTimer);
                }
                e.preventDefault();
                $yesView.fadeOut(function () {
                    $(".feedback-intro", $feedbackView).text("Thanks! Let us know if there's anything we can improve.");
                    $feedbackView.show();
                });
            });
            $(".send", $feedback).click(function () {
                message = $(".feedback-textbox", $feedback).val();
                sendFeedback();
                $feedbackView.fadeOut(function () {
                    $confirmationView.show();
                    setTimeout(function () {
                        $feedback.fadeOut();
                    }, 10000);
                });
            });

            $feedback.removeClass("hidden");
            $feedback.hide();
            $feedback.show();
        });
    </script>
<script type="text/javascript">
        rg4js('apiKey', 'x6kh9H0AxbqPLcjQVaOZNQ==');
        rg4js('enablePulse', true);
        rg4js('enableCrashReporting', true);
    </script>
</body>
</html>
