<!DOCTYPE html>
<html lang="en">
<head>
<title>Home - Octopus Deploy</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="description" content="Octopus Deploy end user documentation">
<meta name="author" content="Octopus Deploy">
<link href="https://octopus.com/Content/css?v=-4KqQQob8dsL5hdI1n8ITu5WSvQ-X4_-0QjLsU2Qxgo1" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" integrity="sha256-NuCn4IvuZXdBaFKJOAcsU2Q3ZpwbdFisd5dux4jkQ5w=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.0/featherlight.min.css" integrity="sha256-Bl4rr1AwUjcb8VvRrdHXqJvRRCyF7oHsgUl74ELjr7k=" crossorigin="anonymous">
<meta name="viewport" content="width=device-width">
<meta property="og:type" content="website">
<meta property="og:title" content="Home - Octopus Deploy">
<meta property="og:description" content="Octopus Deploy end user documentation">
<meta property="og:site_name" content="Octopus Deploy">
<meta property="twitter:card" content="summary">
<meta property="twitter:site" content="@OctopusDeploy">
<meta name="application-name" content="Octopus Deploy">
<link rel="canonical" href="https://octopus.com/docs">
<link rel="me" type="text/html" href="https://plus.google.com/102650558422902813929?rel=me">
<link rel="me" type="text/html" href="http://feeds.feedburner.com/OctopusDeploy">
<link rel="me" type="text/html" href="https://twitter.com/OctopusDeploy">
<link rel="icon" type="image/png" href="https://octopus.com/content/resources/favicon.png">
<link rel="apple-touch-icon" href="https://octopus.com/content/resources/Octopus-96x96.png">
<link href="http://feeds.feedburner.com/OctopusDeploy" type="application/rss+xml" rel="alternate" title="Octopus Deploy Blog Feed">
<script type="text/javascript">
        !function (a, b, c, d, e, f, g) {
            a.RaygunObject = e, a[e] = a[e] || function () {
                    (a[e].o = a[e].o || []).push(arguments)
                }, f = b.createElement(c), g = b.getElementsByTagName(c)[0],
                f.async = 1, f.src = d, g.parentNode.insertBefore(f, g)
        }(window, document, "script", "//cdn.raygun.io/raygun4js/raygun.min.js", "rg4js");
    </script>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css" integrity="sha256-3YM6A3pH4QFCl9WbSU8oXF5N6W/2ylvW0o2g+Z6TmLQ=" crossorigin="anonymous">
<style>
        .btnCopy {
            position: absolute;
            right: 0;
            top: 0;
        }

        .copyToClipboard {
            position: relative;
        }

        @media (min-width: 1200px) {
            .container {
                max-width: 1600px;
                width: 100%;
            }
        }
    </style>
</head>
<body class="">

<script>
        window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) }; ga.l = +new Date;
        ga('create', 'UA-24461753-1', 'auto');
        ga('send', 'pageview');
    </script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>


<script type="text/javascript">
        setTimeout(function () {
            var a = document.createElement("script");
            var b = document.getElementsByTagName("script")[0];
            a.src = document.location.protocol + "//script.crazyegg.com/pages/scripts/0021/2568.js?" + Math.floor(new Date().getTime() / 3600000);
            a.async = true; a.type = "text/javascript"; b.parentNode.insertBefore(a, b)
        }, 1);
    </script>

<div class="top-and-splash">
<div id="top">
<div id="header">
<div class="navbar navbar-fixed-top">
<div class="">
<div class="container">
<div>
<div class="navbar-header">
<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a id="logo" class="navbar-brand" href="/">Octopus Deploy</a>
</div>
<div id="nav-main" class="navbar-collapse collapse">
<div>
<ul class="nav navbar-nav navbar-right">
<li class="">
<a href="/#features">
Features
</a>
</li>
<li class="">
<a href="/downloads">
Downloads
</a>
</li>
<li class="">
<a href="/company/about">
Company
</a>
</li>
<li class="active">
<a href="/docs">
Docs
</a>
</li>
<li class="">
<a href="/support">
Support
</a>
</li>
<li class="">
<a href="/purchase">
Pricing
</a>
</li>
<li class="">
<a href="/blog">Blog</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="middle">
<div id="main">
<div class="stripe stripe-blue">
<div class="container">
<span class="page-title">Octopus Deploy Documentation</span>
</div>
</div>
<div style="padding-left: 16px;" class="stripe stripe-white">
<div class="container">
<div class="row">
<div class="col-md-9">
<div id="doc_content" class="main-content"><h1>Immutable Infrastructure</h1><p>This guide assumes familiarity with Octopus Deploy.  If you don't already know how to set up projects, install Tentacles and configure basic deployment processes it may be helpful to review <a href="/docs/v/3.10/key-concepts">Key Concepts</a> before beginning this guide. Familiarity with the concepts in <a href="/docs/v/3.10/guides/elastic-and-transient-environments">Elastic and Transient Environments</a> would be an added bonus.</p>
<p>The features in <a href="/docs/v/3.10/guides/elastic-and-transient-environments">Elastic and Transient Environments</a> make it easier to deploy infrastructure in addition to applications.  This guide focuses on deploying immutable infrastructure.  Traditionally the infrastructure that hosts applications is mutable: it is constantly changing.  The changes that infrastructure could experience include things like: new firewall rules, operating system updates and patches to your own deployed applications. Immutable infrastructure, as the name suggests, does not change after the initial configuration. In order to apply changes, a new version of the infrastructure is provisioned and the old infrastructure is terminated:</p>
<p><a href='#' data-featherlight='/docs/images/5670238/5865664.png' class='zoom' data-title=''><img src='/docs/images/5670238/5865664.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
<p>In this example we will create an infrastructure project and an application project.  The infrastructure project will provision new Tentacles and terminate the old ones. The application project gets deployed to the Tentacles.  We will then automate deploying our application to brand new infrastructure with each release.</p>
<h2 id="ImmutableInfrastructure-Machinepolicy">Machine policy</h2>
<p>The Tentacles provisioned in this guide belong the to <strong>Immutable Infrastructure</strong> machine policy. For now, create a new machine policy called <strong>Immutable Infrastructure</strong> and leave all of the settings at their default value.</p>
<p><a href='#' data-featherlight='/docs/images/5670238/5865674.png' class='zoom' data-title=''><img src='/docs/images/5670238/5865674.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
<h2 id="ImmutableInfrastructure-Applicationproject">Application project</h2>
<p>For this demonstration, let's create a project called <strong>Hello World</strong> that will run a script echoing &quot;Hello World&quot; to each of our Tentacles.  In practice, this would be the project that deploys your application to the Tentacles.</p>
<ol>
<li><p>Create a project called <strong>Hello World</strong></p>
</li>
<li><p>Add a script step that outputs &quot;Hello World&quot; on each Tentacle:</p>
<p><a href='#' data-featherlight='/docs/images/5670238/5865675.png' class='zoom' data-title=''><img src='/docs/images/5670238/5865675.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
</ol>
<h2 id="ImmutableInfrastructure-Infrastructureproject">Infrastructure project</h2>
<p>The infrastructure project runs a script that provisions two new Tentacles and removes any old Tentacles in the environment we are deploying to. In practice this project would create your new infrastructure, add it to your load balancer and terminate your old infrastructure.</p>
<ol>
<li><p>Download the <a href="/docs/attachments/helloworldinfrastructure.1.0.0.0.zip">HelloWorldInfrastructure.1.0.0.0.zip</a> package that contains the scripts that run in this project and make any modifications required by your Octopus installation.</p>
</li>
<li><p>Upload the package to your Octopus package feed:</p>
<p><a href='#' data-featherlight='/docs/images/5670238/5865676.png' class='zoom' data-title=''><img src='/docs/images/5670238/5865676.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Install Tentacle on the same machine as your Octopus Server (there is no need to configure a Tentacle instance).</p>
</li>
<li><p>Create a project called <strong>Hello World Infrastructure</strong>.</p>
</li>
<li><p>Add a step that runs the script called <strong>Provision.ps1</strong> from the package <strong>HelloWorldInfrastructure</strong> on the Octopus Server:</p>
<p><a href='#' data-featherlight='/docs/images/5670238/5865669.png' class='zoom' data-title=''><img src='/docs/images/5670238/5865669.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Add a step that performs a health check, excluding unavailable machines from the deployment:</p>
<p><a href='#' data-featherlight='/docs/images/5670238/5865670.png' class='zoom' data-title=''><img src='/docs/images/5670238/5865670.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
<li><p>Add a step that runs <strong>Teminate.ps1</strong> from the package <strong>HelloWorldInfrastructure</strong> on the Octopus Server on behalf of all roles:</p>
<p><a href='#' data-featherlight='/docs/images/5670238/5865671.png' class='zoom' data-title=''><img src='/docs/images/5670238/5865671.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
</ol>
<h2 id="ImmutableInfrastructure-Intermission">Intermission</h2>
<p>At this stage you should be able to provision new Tentacles by creating a release of the <strong>Hello World Infrastructure</strong> project and deploying it to an environment. If you create another release of the project and deploy it, the Tentacles for the previous release will be stopped but will remain in the Octopus environment.</p>
<p>You could also create and deploy a release of the <strong>Hello World</strong> project to your shiny new Tentacles, but it requires a lot of button clicking.</p>
<h2 id="ImmutableInfrastructure-Automatingallthethings">Automating all the things</h2>
<p>Imagine a developer makes a change to Hello World and would like to deploy it. At this stage, they would need to create and deploy a release of the Hello World Infrastructure project, wait for the new infrastructure to become available and then create and deploy a release of Hello World.  It is possible but clunky. Also, someone would be required to remove all of the orphaned deployment targets left in Octopus when new Tentacles are provisioned.</p>
<h3 id="ImmutableInfrastructure-Cleaningmachines">Cleaning machines</h3>
<p>Cleaning up old Tentacles can be accomplished through the use of machine policies. The <strong>Immutable Infrastructure</strong> machine policy that we created earlier can be edited so that it performs health checks more frequently, doesn't mind if machines are unavailable during that health check and automatically removes unavailable machines after a period of time.  This is perfect for ensuring the Tentacles that we terminate are automatically cleaned up in a timely manner.</p>
<ol>
<li>Edit the Immutable Infrastructure machine policy.</li>
<li>Change &quot;Time between checks&quot; to 2 minutes</li>
<li>Select &quot;Unavailable machines will not cause health checks to fail&quot;</li>
<li>Select &quot;Automatically delete unavailable machines&quot;</li>
<li>Change &quot;Time unavailable&quot; to 5 minutes</li>
</ol>
<p><a href='#' data-featherlight='/docs/images/5670238/5865677.png' class='zoom' data-title=''><img src='/docs/images/5670238/5865677.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
<h3 id="ImmutableInfrastructure-Automaticallydeploying">Automatically deploying</h3>
<p>The <strong>Hello World</strong> project can be configured to automatically deploy when a new deployment target becomes available.  Once this has been configured, any Tentacles created when <strong>Hello World Infrastructure</strong> is deployed will automatically receive the current successful deployment of the <strong>Hello World</strong> project.</p>
<ol>
<li><p>Create a new trigger for the Hello World project</p>
</li>
<li><p>Select the event &quot;New deployment target becomes available&quot;</p>
<p><a href='#' data-featherlight='/docs/images/5670238/5865666.png' class='zoom' data-title=''><img src='/docs/images/5670238/5865666.png' class="img-fluid center" height="auto" width="500" alt='' /></a></p>
</li>
</ol>
<p>Create and deploy a new release of <strong>Hello World Infrastructure</strong>.  You should notice that immediately after new Tentacles are provisioned, <strong>Hello World</strong> is automatically deployed to those Tentacles:</p>
<p><img src='/docs/images/5670238/5865678.png' class="img-fluid center" alt='' /></p>
<p>We are almost there! Next we need to bump the version of <strong>Hello World</strong> and automatically deploy it.</p>
<h3 id="ImmutableInfrastructure-Automaticallydeployinganewrelease">Automatically deploying a new release</h3>
<p>Octopus will automatically deploy the current successful deployment for a project. That means if you deploy release 1.0.0 and then create release 1.0.1, the version 1.0.0 will continue to be deployed until 1.0.1 has been manually deployed.  This is not ideal for immutable infrastructure, because we do not want to deploy 1.0.1 to our old infrastructure, so we have no way to indicate to Octopus that it should start deploying release 1.0.1.  Enter auto deploy overrides. By creating both a new release and an auto deploy override when our infrastructure is provisioned, we can indicate to Octopus that the new release should be deployed to the new infrastructure.</p>
<ol>
<li>Create an auto deploy override using Octo.exe</li>
</ol>
<pre><code class="language-powershell">Octo.exe create-autodeployoverride --project &quot;Hello World&quot; --environment $environment --version $version --server $octopusURI --apiKey $apiKey
</code></pre>
<h2 id="ImmutableInfrastructure-Magic">Magic</h2>
<p>Wouldn't it be amazing if a developer checked in some changes to <strong>Hello World</strong> and new immutable infrastructure was created with their changes on it? With a few lines of script, your build server can tell Octopus to automatically deploy new infrastructure and deploy the latest release of your project to that infrastructure when it comes online and becomes available to Octopus.  Here is an example that could be adapted to your projects and build server:</p>
<pre><code class="language-powershell">Add-Type -Path 'Octopus.Client.dll'
 
$octopusURI = &quot;http://your-octopus&quot;
$apiKey = &quot;API-ABC123&quot;

$endpoint = New-Object Octopus.Client.OctopusServerEndpoint $octopusURI, $apiKey
$repository = New-Object Octopus.Client.OctopusRepository $endpoint

.\Octo.exe create-release --project &quot;Hello World Infrastructure&quot;  --packageversion &quot;1.0.0.0&quot; --deployto &quot;Development&quot; --server $octopusURI --apiKey $apiKey
.\Octo.exe create-release --project &quot;Hello World&quot; --server $octopusURI --apiKey $apiKey

$project = $repository.Projects.FindByName(&quot;Hello World&quot;)
$release = $repository.Projects.GetReleases($project).Items | Select-Object -first 1
   
.\Octo.exe create-autodeployoverride --project &quot;Hello World&quot; --environment &quot;Development&quot; --version $release.Version --server $octopusURI --apiKey $apiKey

</code></pre>
</div>
</div>
<div class="col-md-3" style="padding-bottom: 100px">
<div class="panel panel-info documentation">
<div class="panel-heading">
<div class="panel-title">
<a href="/docs">Documentation</a>
<div style="margin-top: -3px; margin-bottom: 0" class="dropdown pull-right">
<button class="btn btn-info btn-xs dropdown-toggle" type="button" id="versionSelector" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
Latest
<span class="caret"></span>
</button>
<ul class="dropdown-menu" aria-labelledby="versionSelector"><li class=''><a href='/docs/guides/elastic-and-transient-environments/immutable-infrastructure'>Latest</a></li><li class=''><a href='/docs/v/3.15/guides/elastic-and-transient-environments/immutable-infrastructure'>3.15</a></li><li class=''><a href='/docs/v/3.14/guides/elastic-and-transient-environments/immutable-infrastructure'>3.14</a></li><li class=''><a href='/docs/v/3.13/guides/elastic-and-transient-environments/immutable-infrastructure'>3.13</a></li><li class=''><a href='/docs/v/3.12/guides/elastic-and-transient-environments/immutable-infrastructure'>3.12</a></li><li class=''><a href='/docs/v/3.11/guides/elastic-and-transient-environments/immutable-infrastructure'>3.11</a></li><li class='disabled'><a href='/docs/v/3.10/guides/elastic-and-transient-environments/immutable-infrastructure'>3.10</a></li><li class=''><a href='/docs/v/3.9/guides/elastic-and-transient-environments/immutable-infrastructure'>3.9</a></li><li class=''><a href='/docs/v/3.8/guides/elastic-and-transient-environments/immutable-infrastructure'>3.8</a></li><li class=''><a href='/docs/v/3.7/guides/elastic-and-transient-environments/immutable-infrastructure'>3.7</a></li><li class=''><a href='/docs/v/3.6/guides/elastic-and-transient-environments/immutable-infrastructure'>3.6</a></li></ul>
</div>
</div>
</div>
<div class="panel-body">
<form action="/search" method="get"> <div class="form-search search-only">
<i class="search-icon fa fa-search"></i>
<input id="context" name="context" type="hidden" value="docs">
<input class="form-control search-query" id="q" name="q" placeholder="Search" type="text" value/="">
</div>
</form>
<div class="sidebar">
<ul>
<li>
<a class=" " href="/docs/getting-started">Getting started</a>
</li>
<li>
<a class=" has-children" href="/docs/installation">Installation</a>
</li>
<li>
<a class=" has-children" href="/docs/key-concepts">Key Concepts</a>
</li>
<li>
<a class=" has-children" href="/docs/packaging-applications">Packaging applications</a>
</li>
<li>
<a class=" has-children" href="/docs/deployment-targets">Deployment targets</a>
</li>
<li>
<a class=" has-children" href="/docs/deploying-applications">Deploying applications</a>
</li>
<li>
<a class=" has-children" href="/docs/api-and-integration">API and Integration</a>
</li>
<li>
<a class=" has-children" href="/docs/patterns">Patterns</a>
</li>
<li>
<a class=" has-children" href="/docs/administration">Administration</a>
</li>
<li>
<a class=" has-children" href="/docs/reference">Reference</a>
</li>
<li>
<a class=" has-children" href="/docs/how-to">How to</a>
</li>
<li>
<a class=" has-children" href="/docs/guides">Guides</a>
</li>
</ul>
</div>
</div>
</div>
<div class="text-center">
<a href="https://github.com/OctopusDeploy/docs/blob/master/docs/index.md" class="tutorial" rel="nofollow">Edit this page on GitHub</a>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="bottom">
<div id="footer">
<div class="container">
<div class="row">
<div class="col-md-3">
<strong>Octopus Deploy</strong>
<p>
<a href="/company/about">Company</a>
<br>
<a href="/company/testimonials">Testimonials</a>
<br>
<a href="/company/roadmap">Roadmap</a>
<br>
<a href="/privacy">Privacy policy</a>
<br>
<a href="/company/team">Team</a>
</p>
</div>
<div class="col-md-3">
<strong><a href="/docs" style="color: inherit">Documentation</a></strong>
<p>
<a href="/docs/getting-started">
Getting started
</a>
<br>
<a href="/docs/packaging-applications">
Packaging
</a>
<br>
<a href="/docs/deploying-applications">
Deploying applications
</a>
<br>
<a href="/docs/api-and-integration">
REST API and integration
</a>
<br>
<a href="/docs/how-to">
How to
</a>
</p>
</div>
<div class="col-md-3">
<strong><a href="/support" style="color: inherit">Help &amp; Support</a></strong>
<p>
<a href="http://help.octopusdeploy.com/discussions/problems" class="external">
Problems
</a>
<br>
<a href="http://help.octopusdeploy.com/discussions/questions" class="external">
Questions
</a>
<br>
<a href="https://octopusdeploy.uservoice.com/" class="external">
Suggestions
</a>
<br>
<a href="/videos">
Videos
</a>
<br>
<a href="/company/partners">
Partners
</a>
</p>
</div>
<div class="col-md-3" style="text-align: left">
<strong>Follow us</strong>
<p>
<a href="https://twitter.com/OctopusDeploy"><i class="fa fa-fw fa-twitter" style="color: rgb(85, 172, 238);"></i> @OctopusDeploy</a><br>
<a href="https://github.com/OctopusDeploy"><i class="fa fa-fw fa-github" style="color: white"></i> OctopusDeploy</a><br>
<a href="http://www.youtube.com/c/Octopusdeploy"><i class="fa fa-fw fa-youtube-play" style="color: #D52423"></i> YouTube</a><br>
<a href="http://feeds.feedburner.com/OctopusDeploy"><i class="fa fa-fw fa-rss" style="color: orange"></i> Octopus Deploy Blog</a><br>
<a href="https://confirmsubscription.com/h/d/740FABA4D5BBCE4B"><i class="fa fa-fw fa-envelope" style="color: #7BD678"></i> Newsletter</a><br>
</p>
</div>
</div>
</div>
</div>
</div>
<script src="https://octopus.com/bundles/jquery?v=cnl66tdQfXzonUpL0zSMnDJgJiJJfXbV8tKD-S_8H_Q1"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.0/featherlight.min.js" integrity="sha256-zTDNEf7J+bPdCSndhy8DppFjxfRGG5BFJW5obpl0XQs=" crossorigin="anonymous"></script>
<script type="text/javascript">
        (function ($) {
            var ts;

            $("div.navbar-fixed-top").autoHidingNavbar();

            $.featherlight.defaults.closeOnClick = 'anywhere';
            $.featherlight.defaults.afterOpen = function () {
                ts = + new Date();
                $(window).on('scroll', closeFeatherlightOnScroll);
            };

            function closeFeatherlightOnScroll(event) {
                var nowTs = + new Date();

                if (ts + 500 > nowTs) {
                    return;
                }
                $.featherlight.close(event);
                $(window).off('scroll', closeFeatherlightOnScroll);
            }
        })($);
    </script>
 <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/sql.min.js" integrity="sha256-J7HuqMJTEc5SsyA8nOP0+kVUMGlQq0LrQAvAVgs1k1E=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/powershell.min.js" integrity="sha256-cRUESDACI7Yr/eSmoHs6zDQu6HmpAkCp0s4xrZ9RnE0=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/dockerfile.min.js" integrity="sha256-putofyQv7OB569xAldpyBnHJ0Uc+7VGp5Us05IgDGss=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/fsharp.min.js" integrity="sha256-EwjgDftHUX2pcHkcn19JrQPazoBiHIDivBrellTCYnA=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.2/anchor.min.js" integrity="sha256-WofcoLT8gToeaSmVRe28qpnlFxdBJH1n4K6Bk3YowvU=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twemoji/2.2.3/twemoji.min.js" integrity="sha256-Y3KC8juDUsBOzJ3XtOH/sj+BAlF9AQr6pEey+4ibaJ4=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js" integrity="sha256-Gn7MUQono8LUxTfRA0WZzJgTua52Udm1Ifrk5421zkA=" crossorigin="anonymous"></script>
<script type="text/javascript">
        (function($) {
            $('time').each(function(i, e) {
                var time = moment($(e).attr('datetime')).fromNow();
                $(e).html(time);
            });

            hljs.initHighlightingOnLoad();

            anchors.options.placement = 'left';
            anchors.add('#doc_content > h1, #doc_content > h2, #doc_content > h3, #doc_content > h4');

            twemoji.parse(document.body,
            {
                size: '16x16',
                base: 'https://cdnjs.cloudflare.com/ajax/libs/twemoji/2.2.3/'
            });
            
            function canCopyToClipboard() {
                return window.clipboardData && window.clipboardData.setData ||
                    document.queryCommandSupported && document.queryCommandSupported("copy");
            };

            function copyToClipboard(text) {
                if (window.clipboardData && window.clipboardData.setData) {
                    $(window).trigger("copy", e);
                    return clipboardData.setData("Text", text);

                } else if (document.queryCommandSupported && document.queryCommandSupported("copy")) {
                    var textarea = document.createElement("textarea");
                    textarea.textContent = text;
                    textarea.style.position = "fixed";
                    document.body.appendChild(textarea);
                    textarea.select();
                    try {
                        return document.execCommand("copy");
                    } catch (ex) {
                        console.warn("Copy to clipboard failed.", ex);
                        return false;
                    } finally {
                        document.body.removeChild(textarea);
                    }
                }

                return false;
            };

            if (canCopyToClipboard()) {
                var copyButton =
                    $("<a title=\"Copy to clipboard\" class=\"btnCopy btn btn-default btn-xs\" href=\"#\" role=\"button\">Copy</a>");
                copyButton.click(function (e) {
                    var el = $(this).parent().next().find("code");
                    if (el) {
                        copyToClipboard(el[0].textContent);
                        $(this).attr("title", "Copied!").tooltip("fixTitle").tooltip("show")
                               .attr("title", "Copy to clipboard").tooltip("fixTitle");
                    }
                    e.stopPropagation();
                    return false;
                });

                var wrapperForButton =
                    $("<div class=\"copyToClipboard\"></div>").append(copyButton);

                $("pre").before(wrapperForButton);
                $("a.btnCopy").tooltip();
            }
        })($);
    </script>
<script type="text/javascript">
        rg4js('apiKey', 'x6kh9H0AxbqPLcjQVaOZNQ==');
        rg4js('enablePulse', true);
        rg4js('enableCrashReporting', true);
    </script>


</body>
</html>
